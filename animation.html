<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Circle Animation</title>

<style>
  html, body {
    margin: 0;
    height: 100%;
    background: #000;
    display: grid;
    place-items: center;
  }

  .wrapper {
    position: relative;
    width: 600px;
    height: 600px;
  }

  .hud {
    position: absolute;
    top: 0;
    left: 0;
    width: 600px;
    height: 600px;
    overflow: visible;
    transform-origin: 300px 314px;
  }

  .tick {
    position: absolute;
    width: 2px;
    height: 14px;
    background: #722F37;
    top: 50%;
    left: 50%;
    transform-origin: center bottom;
    opacity: 0;
  }

  .arcs {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: visible;
  }

  .arc {
    fill: none;
    stroke-width: 4;
    stroke-linecap: butt;
  }

  .arc-gray {
    stroke: #3a3a45;
    stroke-width: 12;
    stroke-linecap: round;
    transform-origin: 300px 314px;
    filter: drop-shadow(3px 3px 2px rgba(0,0,0,0.6));
  }

  .arc-red { stroke: #FF4D4D; filter: drop-shadow(0 0 6px #FF4D4D) drop-shadow(0 0 12px #FF4D4D); }
  .arc-orange { stroke: #FF9F1C; filter: drop-shadow(0 0 6px #FF9F1C) drop-shadow(0 0 12px #FF9F1C); }
  .arc-yellow { stroke: #BF00FF; filter: drop-shadow(0 0 6px #BF00FF) drop-shadow(0 0 12px #BF00FF); }
  .arc-lime { stroke: #A6FF4D; filter: drop-shadow(0 0 6px #A6FF4D) drop-shadow(0 0 12px #A6FF4D); }
  .arc-green { stroke: #3DFF9F; filter: drop-shadow(0 0 6px #3DFF9F) drop-shadow(0 0 12px #3DFF9F); }
  .arc-cyan { stroke: #2EE6D6; filter: drop-shadow(0 0 6px #2EE6D6) drop-shadow(0 0 12px #2EE6D6); }
  .arc-blue { stroke: #3DA5FF; filter: drop-shadow(0 0 6px #3DA5FF) drop-shadow(0 0 12px #3DA5FF); }
  .arc-aqua { stroke: #2ED6A1; filter: drop-shadow(0 0 6px #2ED6A1) drop-shadow(0 0 12px #2ED6A1); }

  .circle-purple {
    fill: none;
    stroke: #6B5B7A;
    stroke-width: 1;
    opacity: 0;
  }

  .center-logo {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 160px;
    height: 160px;
    opacity: 0;
    animation: logo-spin 9s linear infinite;
    z-index: 10;
  }

  @keyframes logo-spin {
    from { transform: translate(-50%, -50%) rotate(0deg); }
    to { transform: translate(-50%, -50%) rotate(360deg); }
  }

  .logo-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(calc(-50% + 11px), 90px);
    color: #fff;
    font-family: 'Arial', sans-serif;
    font-size: 24px;
    font-weight: bold;
    letter-spacing: 4px;
    opacity: 0;
    z-index: 10;
  }

  .tagline {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(calc(-50% + 13px), 130px);
    color: #fff;
    font-family: 'Arial', sans-serif;
    font-size: 14px;
    font-weight: bold;
    letter-spacing: 4px;
    opacity: 0;
    z-index: 10;
  }
</style>
</head>

<body>

<div class="wrapper">
  <div class="hud" id="hud"></div>
  <img src="img/logo-160-transparent.png" class="center-logo" id="centerLogo" alt="logo">
  <div class="logo-text" id="logoText">IXTION</div>
  <div class="tagline" id="tagline">Revolutionize IT Automation</div>
</div>

<script type="module">
  import { animate, stagger } from './assets/js/anime.esm.min.js';

  const hud = document.getElementById('hud');
  const COUNT = 160;
  const RADIUS = 275;
  const OUTER_RADIUS = 310;
  const CENTER_X = 300;
  const CENTER_Y = 314;

  const ticks = [];

  // Create all ticks positioned in a circle
  for (let i = 0; i < COUNT; i++) {
    const angle = (i / COUNT) * 360;
    const tick = document.createElement('div');
    tick.className = 'tick';
    tick.style.transform = `rotate(${angle}deg) translateY(-${RADIUS}px)`;
    hud.appendChild(tick);
    ticks.push(tick);
  }

  // Create SVG for arcs
  const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
  svg.setAttribute('class', 'arcs');
  svg.setAttribute('viewBox', '0 0 600 600');
  svg.style.overflow = 'visible';
  hud.appendChild(svg);

  // Helper to create arc path
  function createArc(startAngle, endAngle, radius) {
    const startRad = (startAngle - 90) * Math.PI / 180;
    const endRad = (endAngle - 90) * Math.PI / 180;
    const x1 = CENTER_X + radius * Math.cos(startRad);
    const y1 = CENTER_Y + radius * Math.sin(startRad);
    const x2 = CENTER_X + radius * Math.cos(endRad);
    const y2 = CENTER_Y + radius * Math.sin(endRad);
    const largeArc = endAngle - startAngle > 180 ? 1 : 0;
    return `M ${x1} ${y1} A ${radius} ${radius} 0 ${largeArc} 1 ${x2} ${y2}`;
  }

  // 8 arcs, clockwise from top, each ~35° with ~10° gaps
  const arcColors = ['red', 'orange', 'yellow', 'lime', 'green', 'cyan', 'blue', 'aqua'];
  const arcSpan = 40;
  const arcGap = 5;
  const startOffset = 2; // 2 is the correct value for now
  const allArcs = [];

  arcColors.forEach((color, i) => {
    const startAngle = startOffset + i * (arcSpan + arcGap);
    const endAngle = startAngle + arcSpan;
    const arc = document.createElementNS('http://www.w3.org/2000/svg', 'path');
    arc.setAttribute('class', `arc arc-${color}`);
    arc.setAttribute('d', createArc(startAngle, endAngle, OUTER_RADIUS));
    arc.style.opacity = 0;
    svg.appendChild(arc);
    allArcs.push(arc);
  });

  // Purple circles between tick circle and gray arcs
  const MIDDLE_RADIUS = 252;
  const purpleCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
  purpleCircle.setAttribute('class', 'circle-purple');
  purpleCircle.setAttribute('cx', CENTER_X);
  purpleCircle.setAttribute('cy', CENTER_Y);
  purpleCircle.setAttribute('r', MIDDLE_RADIUS);
  svg.appendChild(purpleCircle);

  const purpleCircle2 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
  purpleCircle2.setAttribute('class', 'circle-purple');
  purpleCircle2.setAttribute('cx', CENTER_X);
  purpleCircle2.setAttribute('cy', CENTER_Y);
  purpleCircle2.setAttribute('r', MIDDLE_RADIUS + 3);
  svg.appendChild(purpleCircle2);

  // Outer pair of purple circles (10px gap from inner pair)
  const purpleCircle3 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
  purpleCircle3.setAttribute('class', 'circle-purple');
  purpleCircle3.setAttribute('cx', CENTER_X);
  purpleCircle3.setAttribute('cy', CENTER_Y);
  purpleCircle3.setAttribute('r', MIDDLE_RADIUS + 13);
  svg.appendChild(purpleCircle3);

  const purpleCircle4 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
  purpleCircle4.setAttribute('class', 'circle-purple');
  purpleCircle4.setAttribute('cx', CENTER_X);
  purpleCircle4.setAttribute('cy', CENTER_Y);
  purpleCircle4.setAttribute('r', MIDDLE_RADIUS + 16);
  svg.appendChild(purpleCircle4);

  // Gray inner arc - 1/7 of circle, just inside the tick circle
  const INNER_RADIUS = 230;
  const grayArcSpan = 360 / 7; // ~51.4°

  // Create gradient for shadow effect
  const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
  const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
  gradient.setAttribute('id', 'grayArcGradient');
  gradient.setAttribute('x1', '0%');
  gradient.setAttribute('y1', '0%');
  gradient.setAttribute('x2', '100%');
  gradient.setAttribute('y2', '100%');

  const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
  stop1.setAttribute('offset', '0%');
  stop1.setAttribute('stop-color', '#5a5a65');

  const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
  stop2.setAttribute('offset', '100%');
  stop2.setAttribute('stop-color', '#1a1a20');

  gradient.appendChild(stop1);
  gradient.appendChild(stop2);
  defs.appendChild(gradient);

  // Second gradient for opposite shadow direction
  const gradient2 = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
  gradient2.setAttribute('id', 'grayArcGradient2');
  gradient2.setAttribute('x1', '100%');
  gradient2.setAttribute('y1', '100%');
  gradient2.setAttribute('x2', '0%');
  gradient2.setAttribute('y2', '0%');

  const stop3 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
  stop3.setAttribute('offset', '0%');
  stop3.setAttribute('stop-color', '#5a5a65');

  const stop4 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
  stop4.setAttribute('offset', '100%');
  stop4.setAttribute('stop-color', '#1a1a20');

  gradient2.appendChild(stop3);
  gradient2.appendChild(stop4);
  defs.appendChild(gradient2);

  svg.appendChild(defs);

  const grayArc = document.createElementNS('http://www.w3.org/2000/svg', 'path');
  grayArc.setAttribute('class', 'arc arc-gray');
  grayArc.setAttribute('d', createArc(0, grayArcSpan, INNER_RADIUS));
  grayArc.style.stroke = 'url(#grayArcGradient)';
  grayArc.style.opacity = 0;
  svg.appendChild(grayArc);

  // Second gray arc - 160 degrees offset from the first
  const grayArc2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
  grayArc2.setAttribute('class', 'arc arc-gray');
  grayArc2.setAttribute('d', createArc(160, 160 + grayArcSpan, INNER_RADIUS));
  grayArc2.style.stroke = 'url(#grayArcGradient2)';
  grayArc2.style.opacity = 0;
  svg.appendChild(grayArc2);

  // Step 1: Show first tick and blink 3 times
  ticks[0].style.opacity = 1;

  animate(ticks[0], {
    opacity: [1, 0, 1, 0, 1, 0, 1],
    duration: 600,
    ease: 'linear'
  }).then(() => {
    // Step 2: After blinking, animate all ticks expanding from the top
    const tickAnim = animate(ticks, {
      opacity: [0, 1],
      scaleY: [0, 1],
      duration: 400,
      delay: stagger(5, { from: 0 }),
      ease: 'out(3)'
    });

    // Start arcs just before circle completes (with 0.2s delay)
    setTimeout(() => {
      // Pick first random arc and its opposite (4 positions apart)
      const randomIndex1 = Math.floor(Math.random() * 4);
      const oppositeIndex1 = randomIndex1 + 4;
      const firstArcs = [allArcs[randomIndex1], allArcs[oppositeIndex1]];

      // Pick second random arc and its opposite from remaining indices
      const availableIndices = [0,1,2,3].filter(i => i !== randomIndex1);
      const randomIndex2 = availableIndices[Math.floor(Math.random() * availableIndices.length)];
      const oppositeIndex2 = randomIndex2 + 4;
      const secondArcs = [allArcs[randomIndex2], allArcs[oppositeIndex2]];

      // Remaining 4 arcs
      const usedIndices = [randomIndex1, oppositeIndex1, randomIndex2, oppositeIndex2];
      const finalArcs = allArcs.filter((_, i) => !usedIndices.includes(i));

      // Wait 0.2s then fade in first two opposite arcs
      setTimeout(() => {
        animate(firstArcs, {
        opacity: [0, 1],
        duration: 200,
        ease: 'out(2)'
      }).then(() => {
        // Blink first two arcs - after first blink, load second pair
        animate(firstArcs, {
          opacity: [1, 0, 1],
          duration: 200,
          ease: 'linear'
        }).then(() => {
          // Load second pair of arcs and blink + start inner gray arcs
          animate(secondArcs, {
            opacity: [0, 1],
            duration: 200,
            ease: 'out(2)'
          }).then(() => {
            animate(secondArcs, {
              opacity: [1, 0, 1, 0, 1],
              duration: 400,
              ease: 'linear'
            });
            // Load final 4 arcs and blink
            animate(finalArcs, {
              opacity: [0, 1],
              duration: 200,
              ease: 'out(2)'
            }).then(() => {
              animate(finalArcs, {
                opacity: [1, 0, 1, 0, 1],
                duration: 400,
                ease: 'linear'
              });
            });
          });

          // Start inner gray arcs at step 2
          animate([grayArc, grayArc2], {
            opacity: [0, 1],
            rotate: [0, 280],
            duration: 2000,
            ease: 'out(3)'
          });

          // Fade in purple circles after gray arcs start
          setTimeout(() => {
            animate([purpleCircle, purpleCircle2, purpleCircle3, purpleCircle4], {
              opacity: [0, 1],
              duration: 1500,
              ease: 'out(2)'
            });
          }, 300);

          // Continue blinking first arcs (second blink)
          animate(firstArcs, {
            opacity: [1, 0, 1],
            duration: 200,
            ease: 'linear'
          }).then(() => {
            // After second blink, zoom in
            animate(hud, {
              scale: [1, 1.22],
              duration: 3500,
              ease: 'out(3)'
            });
            // Fade in the center logo
            const centerLogo = document.getElementById('centerLogo');
            animate(centerLogo, {
              opacity: [0, 1],
              duration: 2000,
              ease: 'out(2)'
            });
            // Fade in the text 1s later
            const logoText = document.getElementById('logoText');
            setTimeout(() => {
              animate(logoText, {
                opacity: [0, 1],
                duration: 3000,
                ease: 'out(2)'
              });

              // After IXTION loaded for 2s, blink 4 random opposite arcs
              setTimeout(() => {
                // Pick 2 pairs of opposite arcs
                const blinkIndex1 = Math.floor(Math.random() * 4);
                const blinkIndex2 = [0,1,2,3].filter(i => i !== blinkIndex1)[Math.floor(Math.random() * 3)];
                const blinkArcs = [
                  allArcs[blinkIndex1], allArcs[blinkIndex1 + 4],
                  allArcs[blinkIndex2], allArcs[blinkIndex2 + 4]
                ];

                animate(blinkArcs, {
                  opacity: [1, 0, 1, 0, 1, 0, 1],
                  duration: 600,
                  ease: 'linear'
                }).then(() => {
                  // Spin fast and fade away everything except logo and text
                  animate(hud, {
                    rotate: [0, 1080],
                    duration: 2500,
                    ease: 'in(2)'
                  });
                  // Fade out all arcs and ticks
                  animate([...allArcs, ...ticks, grayArc, grayArc2, purpleCircle, purpleCircle2, purpleCircle3, purpleCircle4], {
                    opacity: [1, 0],
                    duration: 2500,
                    ease: 'in(2)'
                  });
                  // Fade in tagline slowly
                  const tagline = document.getElementById('tagline');
                  animate(tagline, {
                    opacity: [0, 1],
                    duration: 3000,
                    ease: 'out(2)'
                  });
                });
              }, 2000);
            }, 1000);
          });
        });
      });
      }, 200);
    }, 480);

    tickAnim.then(() => {
      // Step 3: Once complete, increase size and make bold
      animate(ticks, {
        scaleY: [1, 1.3],
        scaleX: [1, 1.8],
        duration: 400,
        ease: 'out(2)'
      });
    });
  });
</script>

</body>
</html>
